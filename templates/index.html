<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Routing Cikarang</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <div id="sidebar">
        <h3>ğŸš— Smart Route Cikarang</h3>
        
        <label>Asal:</label>
        <select id="startLoc">
            {% for loc in locations %}
            <option value="{{ loc }}">{{ loc }}</option>
            {% endfor %}
        </select>
        
        <label>Tujuan:</label>
        <select id="endLoc">
            {% for loc in locations %}
            <option value="{{ loc }}" {% if loop.last %}selected{% endif %}>{{ loc }}</option>
            {% endfor %}
        </select>

        <button id="btnCalculate">ğŸ” Hitung Rute & Analisis</button>

        <div id="analyticsCard" class="card" style="display:none; margin-top: 20px;">
            <h4>ğŸ“Š Tren Historis (AI Prediction)</h4>
            <p style="font-size: 12px; color: #666;">Analisis dari 4.000+ data lalu lintas.</p>
        
            <div style="margin-bottom: 10px;">
                <small>Status Jalan:</small><br>
                <b id="algoStatus" style="color: #007bff;">-</b>
            </div>
        
            <canvas id="predictionChart" width="280" height="200"></canvas>
        </div>
        
        <div id="resultCard" class="card" style="display:none;">
            <h4>Analisis Perjalanan</h4>
            <div class="stat-row"><span>ğŸ“ Jarak:</span> <span id="distVal" class="val">-</span></div>
            <div class="stat-row"><span>â±ï¸ ETA Normal:</span> <span id="baseEta" class="val">-</span></div>
            <hr>
            <div class="stat-row" style="font-size: 16px;">
                <span>ğŸš€ <b>Estimasi Waktu:</b></span> 
                <span id="finalEta" class="val" style="color:#28a745">-</span>
            </div>
            <div id="weatherAlert" class="alert"></div>
            <div class="congestion-box">
                <div class="congestion-label">
                    <span>Tingkat Kemacetan:</span>
                    <span id="congestionPercent">0%</span>
                </div>
                <div class="progress-bar-bg">
                    <div id="congestionBar" class="progress-bar-fill"></div>
                </div>
                <small id="delayText" style="color: #666; font-size: 11px; display:block; margin-top:5px;">
                    Tidak ada penundaan.
                </small>
            </div>
        </div>

        <div id="conditionCard" class="card" style="display:none;">
            <h4>Kondisi Lapangan</h4>
            
            <small>ğŸ“ Lokasi Asal:</small>
            <div class="stat-row"><span>ğŸš¦ Speed:</span> <span id="sSpeed" class="val">-</span></div>
            <div class="stat-row"><span>ğŸŒ¡ï¸ Suhu:</span> <span id="sTemp" class="val">-</span></div>
            <div class="stat-row"><span>ğŸŒ¦ï¸ Cuaca:</span> <span id="sWeather" class="val">-</span></div>
            <div class="stat-row" style="font-size: 12px; color: #666;"><span>ğŸ’§ Curah Hujan:</span> <span id="sRain">-</span></div>
            
            <hr style="margin: 10px 0;">
        
            <small>ğŸ“ Lokasi Tujuan:</small>
            <div class="stat-row"><span>ğŸš¦ Speed:</span> <span id="eSpeed" class="val">-</span></div>
            <div class="stat-row"><span>ğŸŒ¡ï¸ Suhu:</span> <span id="eTemp" class="val">-</span></div>
            <div class="stat-row"><span>ğŸŒ¦ï¸ Cuaca:</span> <span id="eWeather" class="val">-</span></div>
            <div class="stat-row" style="font-size: 12px; color: #666;"><span>ğŸ’§ Curah Hujan:</span> <span id="eRain">-</span></div>
        </div>
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>